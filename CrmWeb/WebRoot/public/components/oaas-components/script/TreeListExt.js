/* @edit moejoe(lmh_user@hotmail.com) */function TreeListExt(treelistName,fm1,submitButton){this.treelist=document.all(treelistName);this.click=function(){var selItem=this.treelist.selectedItem;this.setInputData(selItem.getColumnData());this.setButtonData();};this.setInputData=function(pObj){this.objectToForm(pObj);};this.base=FormExt;this.setButtonData=function(pAvail,pBtnValue){this.submitButton.disabled=!pAvail;if(pBtnValue)this.submitButton.value=pBtnValue;};this.loadData=function(remoteObj){if(remoteObj){if(typeof(remoteObj)=="string")this.treelist.loadByXML(remoteObj);else this.treelist.loadByData(remoteObj);};};this.base(fm1);this.submit=function(remoteObj){if(this.validator())return;this.nodeOperate(this.formToObject(),remoteObj);};this.submitButton=this.item(submitButton);this.nodeOperate=function(formObject,remoteObj){try{if(eval(remoteObj.condition)){var recObj=eval(remoteObj.editMethod);if(recObj)formObject=recObj;var _nd=this.treelist.selectedItem;_nd.clone(formObject);_nd.refresh();alert(CHK_TYPE_CON.submitMsg2);}else{formObject=eval(remoteObj.addMethod);var _nd=this.treelist.createTreeNode();_nd.clone(formObject);this.treelist.add(_nd);alert(CHK_TYPE_CON.submitMsg1);};_nd.setSelected();}catch(e){return true;};this.reset();this.setButtonData();};this.reset = function(){this.form.reset();this.setButtonData();};}